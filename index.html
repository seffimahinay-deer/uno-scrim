<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UNO x DEER Scrimmage Academy</title>

<style>
:root{--primary:#e63946;--bg:#121212;--card:#1f1f1f;}
body{margin:0;font-family:Segoe UI;background:var(--bg);color:white;text-align:center;
background-image:url('academy-logo.png.PNG');background-size:40%;background-repeat:no-repeat;background-position:center;background-attachment:fixed;}
.overlay{background:rgba(18,18,18,.92);min-height:100vh;padding:20px;}
.header{display:flex;justify-content:space-around;align-items:center;margin-bottom:15px;}
.header img{width:55px;height:55px;border-radius:50%;}
.academy-logo{width:90px!important;height:90px!important;}
.btn-main{background:var(--primary);border:none;padding:12px 25px;color:white;font-weight:bold;border-radius:6px;}
.date-text{margin-top:10px;color:#ffcc00;font-weight:bold;}
.info-box{background:var(--card);padding:15px;border-radius:8px;margin:15px auto;max-width:500px;font-size:.85rem;text-align:left;}
.scrim-list{display:none;margin-top:20px;max-width:550px;margin-left:auto;margin-right:auto;}
details{background:var(--card);margin-bottom:8px;border-radius:8px;border:1px solid #333;}
summary{padding:15px;display:flex;justify-content:space-between;font-weight:bold;cursor:pointer;}
.match-slot{background:#2a2a2a;margin:10px;padding:12px;border-radius:6px;border-left:4px solid var(--primary);}
.vs-row{display:flex;justify-content:space-between;align-items:center;}
.vs-row input{width:42%;background:#111;border:1px solid #444;color:white;padding:8px;border-radius:4px;}
.score-row{display:flex;align-items:center;justify-content:center;gap:8px;margin-top:10px;}
select{background:#111;color:white;border:1px solid #444;padding:5px;border-radius:4px;}
.btn-ok{background:#28a745;border:none;color:white;padding:5px 12px;border-radius:4px;}
.btn-ok:disabled{background:#555;}
.winner-tag{margin-top:5px;color:#ffcc00;font-size:.85rem;font-weight:bold;}
.footer-icons{margin-top:50px;font-size:1.8rem;letter-spacing:15px;cursor:pointer;opacity:.7;}
.admin-area{display:none;margin-top:20px;padding:15px;border:1px dashed #ffcc00;border-radius:8px;}
.admin-controls button{margin:5px;background:#444;color:white;border:none;padding:6px 10px;border-radius:4px;}
</style>
</head>

<body>
<div class="overlay">

<div class="header">
<img src="uno-logo.png.PNG">
<div>
<div>‚ú°Ô∏èUNO x ü¶åDEER Scrimmage Academy</div>
<img src="academy-logo.png.PNG" class="academy-logo">
<div style="font-size:.75rem;">Owned by Seffi and Hannah</div>
</div>
<img src="deer-logo.png.PNG">
</div>

<button class="btn-main" onclick="toggleList()">View List</button>
<div class="date-text" id="date"></div>

<div class="info-box">
üåü POINTS SYSTEM üåü<br><br>
2-0 = 3pts | 1pt<br>
2-1 = 3pts | 2pts<br>
1-2 = 2pts | 3pts<br>
DQ-2 = 0pt | 3pts<br>
2-DQ = 3pts | 0pt<br><br>
MONDAY-FRIDAY ‚Äì Daily Scrim<br>
SATURDAY ‚Äì Tally of Points<br>
SUNDAY ‚Äì Bi-Weekly Tournament (Top 32)<br>
February 15, 2026<br>
March 1, 2026<br><br>
PRIZES:<br>
üèÜChampion ‚Äì ‚Ç±1500 + e-cert<br>
ü•áRunner-Up ‚Äì ‚Ç±500 + e-cert<br>
ü•àü•âSemi ‚Äì e-cert<br>
Monthly Top1 ‚Äì ‚Ç±1000 + e-certificate<br>
Monthly Top2 - 5 Starlights via gifting + e-certificate<br>
Monthly Top3 - e-certificate
</div>

<div class="scrim-list" id="container"></div>

<div class="footer-icons">
<span>‚ú°Ô∏è</span>
<span onclick="adminLogin()">üîí</span>
<span>ü¶å</span>
</div>

<div id="adminPanel" class="admin-area">
<div>Admin Mode Active</div>
<button onclick="resetDay()">Reset Daily List</button>
</div>

</div>

<!-- Firebase CDN COMPAT VERSION -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
/* =============================
   FIREBASE INITIALIZATION
============================= */

const firebaseConfig = {
  apiKey: "AIzaSyBZ5p9HbxcdOZTX9cKpJuboajxqCk5kLkU",
  authDomain: "uno-x-deer-scrim.firebaseapp.com",
  databaseURL: "https://uno-x-deer-scrim-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "uno-x-deer-scrim",
  storageBucket: "uno-x-deer-scrim.firebasestorage.app",
  messagingSenderId: "553694902384",
  appId: "1:553694902384:web:8608acf13b1044b8fadcb5"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* =============================
   GLOBAL STATE
============================= */

let isAdmin = false;

const times = [
"7:00PM","7:30PM","8:00PM","8:30PM","9:00PM",
"9:30PM","10:00PM","10:30PM","11:00PM","11:30PM"
];

const container = document.getElementById("container");

/* =============================
   DATE
============================= */

document.getElementById("date").innerText =
new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'});

/* =============================
   UI TOGGLE
============================= */

function toggleList(){
container.style.display =
container.style.display === "block" ? "none" : "block";
}
window.toggleList = toggleList;

/* =============================
   ADMIN
============================= */

function adminLogin(){
if(prompt("Passcode:") === "011226"){
isAdmin = true;
document.getElementById("adminPanel").style.display = "block";
document.querySelectorAll(".admin-controls")
.forEach(el=> el.style.display="block");
alert("Admin mode activated");
}
}
window.adminLogin = adminLogin;

function resetDay(){
if(confirm("Reset entire day?")){
db.ref("scrims").remove();
}
}
window.resetDay = resetDay;

/* =============================
   BUILD TIME SLOTS
============================= */

function build(){
times.forEach(time=>{
const id = time.replace(":","");
const details = document.createElement("details");

details.innerHTML = `
<summary>${time}
<span id="count-${id}" style="font-size:.7rem;color:#aaa;">
Available:5 | Confirmed:0
</span>
</summary>

<div id="matches-${id}"></div>

<div class="admin-controls" id="admin-time-${id}" style="display:none;text-align:center;margin:5px;">
<button onclick="addSlot('${time}')">+ Slot</button>
<button onclick="removeSlot('${time}')">- Slot</button>
</div>
`;

container.appendChild(details);

const matchContainer = document.getElementById(`matches-${id}`);

for(let i=1;i<=5;i++){
createMatch(matchContainer,time,i);
}
});
}

function createMatch(parent,time,index){

const id = time.replace(":","");

const div = document.createElement("div");
div.className = "match-slot";
div.id = `slot-${id}-${index}`;

div.innerHTML = `
<div class="vs-row">
<input id="${id}-${index}-t1" placeholder="Team 1">
<span>vs</span>
<input id="${id}-${index}-t2" placeholder="Team 2">
</div>

<div class="score-row" id="score-ui-${id}-${index}">
<select id="s1-${id}-${index}">
<option value="">-</option>
<option>2</option>
<option>1</option>
<option>0</option>
<option>DQ</option>
</select>
-
<select id="s2-${id}-${index}">
<option value="">-</option>
<option>2</option>
<option>1</option>
<option>0</option>
<option>DQ</option>
</select>
<button id="ok-${id}-${index}" disabled>OK</button>
</div>

<div id="win-${id}-${index}" class="winner-tag"></div>

<div class="admin-controls" id="admin-${id}-${index}" style="display:none;">
<button onclick="unlockTeams('${time}',${index})">Unlock Teams</button>
<button onclick="unlockScore('${time}',${index})">Unlock Score</button>
</div>
`;

parent.appendChild(div);

/* TEAM SAVE */

document.getElementById(`${id}-${index}-t1`)
.addEventListener("change",e=> saveTeam(time,index,"t1",e.target.value));

document.getElementById(`${id}-${index}-t2`)
.addEventListener("change",e=> saveTeam(time,index,"t2",e.target.value));

/* SCORE CHECK */

document.getElementById(`s1-${id}-${index}`)
.addEventListener("change",()=> checkScore(id,index));

document.getElementById(`s2-${id}-${index}`)
.addEventListener("change",()=> checkScore(id,index));

document.getElementById(`ok-${id}-${index}`)
.addEventListener("click",()=> lockScore(time,index));
}

/* =============================
   TEAM SAVE WITH TRANSACTION
============================= */

function saveTeam(time,index,pos,name){

if(!confirm("Confirm team name? After confirming it will be locked.")) return;

const id = time.replace(":","");
const path = `scrims/${id}/${index}/${pos}`;

db.ref(path).transaction(current=>{
if(current && !isAdmin){
alert("Slot already taken. Please refresh.");
return;
}
return name;
});
}

/* =============================
   SCORE LOGIC
============================= */

function checkScore(id,index){
const s1 = document.getElementById(`s1-${id}-${index}`).value;
const s2 = document.getElementById(`s2-${id}-${index}`).value;

document.getElementById(`ok-${id}-${index}`).disabled =
(s1 === "" || s2 === "");
}

function determineWinner(t1,t2,s1,s2){
if(s1 === "DQ") return t2;
if(s2 === "DQ") return t1;
if(parseInt(s1) > parseInt(s2)) return t1;
if(parseInt(s2) > parseInt(s1)) return t2;
return "Draw";
}

function lockScore(time,index){

if(!confirm("Lock score? It cannot be modified unless admin unlocks.")) return;

const id = time.replace(":","");

const s1 = document.getElementById(`s1-${id}-${index}`).value;
const s2 = document.getElementById(`s2-${id}-${index}`).value;

db.ref(`scrims/${id}/${index}/score`)
.set({ s1, s2, locked:true });
}

/* =============================
   ADMIN UNLOCK
============================= */

function unlockTeams(time,index){
if(!isAdmin) return;
const id = time.replace(":","");
db.ref(`scrims/${id}/${index}/t1`).remove();
db.ref(`scrims/${id}/${index}/t2`).remove();
}
window.unlockTeams = unlockTeams;

function unlockScore(time,index){
if(!isAdmin) return;
const id = time.replace(":","");
db.ref(`scrims/${id}/${index}/score`).remove();
}
window.unlockScore = unlockScore;

/* =============================
   ADD / REMOVE SLOT
============================= */

function addSlot(time){
if(!isAdmin) return;
const id = time.replace(":","");
const container = document.getElementById(`matches-${id}`);
const next = container.children.length + 1;
createMatch(container,time,next);
}
window.addSlot = addSlot;

function removeSlot(time){
if(!isAdmin) return;
const id = time.replace(":","");
const container = document.getElementById(`matches-${id}`);
const last = container.children.length;
if(last > 0){
db.ref(`scrims/${id}/${last}`).remove();
container.removeChild(container.lastChild);
}
}
window.removeSlot = removeSlot;

/* =============================
   REAL-TIME SYNC
============================= */

db.ref("scrims").on("value",snap=>{

const data = snap.val() || {};

times.forEach(time=>{
const id = time.replace(":","");
const slot = data[id] || {};
let confirmed = 0;

Object.keys(slot).forEach(key=>{

const match = slot[key];
const t1Input = document.getElementById(`${id}-${key}-t1`);
const t2Input = document.getElementById(`${id}-${key}-t2`);

if(t1Input){
t1Input.value = match.t1 || "";
t1Input.disabled = !!match.t1;
}

if(t2Input){
t2Input.value = match.t2 || "";
t2Input.disabled = !!match.t2;
}

if(match.t1 && match.t2) confirmed++;

if(match.score?.locked){

const scoreUI = document.getElementById(`score-ui-${id}-${key}`);
scoreUI.innerHTML = `
Score: ${match.score.s1} - ${match.score.s2}
<span style="font-size:1.1rem;">üîí</span>
`;

const win = determineWinner(match.t1,match.t2,match.score.s1,match.score.s2);

const winArea = document.getElementById(`win-${id}-${key}`);
if(winArea) winArea.innerText = "Winner: " + win;
}
});

const count = document.getElementById(`count-${id}`);
if(count){
const totalSlots = document.getElementById(`matches-${id}`).children.length;
count.innerText = `Available:${totalSlots-confirmed} | Confirmed:${confirmed}`;
}
});
});

/* =============================
   INIT
============================= */

build();
</script>
</body>
</html>
